<!DOCTYPE html>
<html>
<head>
    <title>Video Upload Diagnostics</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .info-box { background: #f0f8ff; padding: 15px; border-left: 4px solid #007bff; margin: 10px 0; }
        .error-box { background: #fff5f5; padding: 15px; border-left: 4px solid #dc3545; margin: 10px 0; }
        .success-box { background: #f0fff4; padding: 15px; border-left: 4px solid #28a745; margin: 10px 0; }
        .warning-box { background: #fffbf0; padding: 15px; border-left: 4px solid #ffc107; margin: 10px 0; }
        input[type="file"] { margin: 10px 0; padding: 10px; border: 2px solid #ddd; border-radius: 5px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üé• Video Upload Diagnostics</h1>
    
    <div class="info-box">
        <h3>Current PHP Limits:</h3>
        <ul>
            <li><strong>upload_max_filesize:</strong> <?php echo ini_get('upload_max_filesize'); ?></li>
            <li><strong>post_max_size:</strong> <?php echo ini_get('post_max_size'); ?></li>
            <li><strong>max_execution_time:</strong> <?php echo ini_get('max_execution_time'); ?> seconds</li>
            <li><strong>memory_limit:</strong> <?php echo ini_get('memory_limit'); ?></li>
        </ul>
    </div>

    <div class="warning-box">
        <h3>‚ö†Ô∏è Issue Detected:</h3>
        <p>Your current upload limit is only <strong><?php echo ini_get('upload_max_filesize'); ?></strong>, but you're trying to upload a video that might be larger.</p>
        <p>Even a 0.41-second video can be large if it's high resolution or uncompressed!</p>
    </div>

    <h3>üìÅ Check Your Video File Size:</h3>
    <input type="file" id="videoFile" accept="video/*">
    <div id="fileInfo"></div>

    <div class="success-box" id="solution" style="display: none;">
        <h3>‚úÖ Quick Solution:</h3>
        <ol>
            <li><strong>Run the auto-fix:</strong> Double-click <code>fix-xampp-upload.bat</code> in your project folder</li>
            <li><strong>Or manually edit:</strong> <code>C:\xampp\php\php.ini</code> and change:
                <pre>upload_max_filesize = 500M
post_max_size = 500M</pre>
            </li>
            <li><strong>Restart Apache</strong> in XAMPP Control Panel</li>
            <li><strong>Restart Laravel:</strong> <code>php artisan serve</code></li>
        </ol>
    </div>

    <script>
        document.getElementById('videoFile').addEventListener('change', function() {
            const file = this.files[0];
            const infoDiv = document.getElementById('fileInfo');
            const solutionDiv = document.getElementById('solution');
            
            if (file) {
                const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2);
                const fileSizeBytes = file.size;
                const currentLimitMB = <?php echo (int)ini_get('upload_max_filesize'); ?>;
                
                let statusClass = 'success-box';
                let statusText = '‚úÖ This file should upload successfully!';
                
                if (fileSizeBytes > currentLimitMB * 1024 * 1024) {
                    statusClass = 'error-box';
                    statusText = '‚ùå This file is TOO LARGE for current settings!';
                    solutionDiv.style.display = 'block';
                } else if (fileSizeMB > 5) {
                    statusClass = 'warning-box';
                    statusText = '‚ö†Ô∏è Large file - might take time to upload';
                }
                
                infoDiv.innerHTML = `
                    <div class="${statusClass}">
                        <h4>${statusText}</h4>
                        <p><strong>File name:</strong> ${file.name}</p>
                        <p><strong>File size:</strong> ${fileSizeMB} MB (${fileSizeBytes.toLocaleString()} bytes)</p>
                        <p><strong>File type:</strong> ${file.type}</p>
                        <p><strong>Current limit:</strong> ${currentLimitMB} MB</p>
                        ${fileSizeBytes > currentLimitMB * 1024 * 1024 ? 
                            `<p><strong>Exceeds limit by:</strong> ${(fileSizeMB - currentLimitMB).toFixed(2)} MB</p>` : 
                            `<p><strong>Within limit:</strong> ${(currentLimitMB - fileSizeMB).toFixed(2)} MB remaining</p>`}
                    </div>
                `;
            } else {
                infoDiv.innerHTML = '';
                solutionDiv.style.display = 'none';
            }
        });
    </script>
</body>
</html>